{% load i18n %}

<form method="post" novalidate class="{% if is_readonly and not user_is_validator %}readonly{% endif %}">
  {% csrf_token %}
  
  {% if form.management_form %}
  <div style="display:none">{{ form.management_form }}</div>
  
  <table class="table table-striped table-bordered">
    <thead>
      <tr>
        <th>Matricola</th>
        <th>Nome</th>
        <th>Elimina</th>
      </tr>
    </thead>
    <tbody>
      {% for f in form %}
      <tr style="{% if f.instance.pk %}{% else %}display:none;{% endif %}">
        <div style="display:none;">
          {{ f.id }}
          {{ f.alta_formazione_dati_base }}
        </div>
        <td>{{ f.matricola_cons }}</td>
        <td>{{ f.nome_origine_cons }}</td>
        <td>{% if not is_readonly or user_is_validator %}{{ f.DELETE }}{% endif %}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
  {% else %}
  <div class="alert alert-warning">
    <i class="fas fa-exclamation-triangle"></i>
    Nessun form disponibile. Questo potrebbe indicare un problema con il formset.
  </div>
  {% endif %}

  <input type="hidden" name="tab_form_dict_key" value="Consiglio Scientifico Interno">

  <div class="mt-3 d-flex justify-content-between">
    {% if not is_readonly or user_is_validator %}
    <button type="submit" class="btn btn-primary">
      <i class="fas fa-save"></i> Salva Consiglio Scientifico Interno
    </button>
    {% endif %}

    <a href="{% url 'advanced-training:management:advanced-training' %}" 
       class="btn btn-outline-secondary btn-sm">
      <i class="fas fa-arrow-left"></i> {% trans "Torna alla lista" %}
    </a>
  </div>
</form>