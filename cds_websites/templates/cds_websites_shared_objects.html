{% extends "storage_crud_base.html" %}

{% load i18n %}
{% load static %}
{% load management_templatetags %}

{% block extra_head %}
{{ block.super }}
<link rel="stylesheet" href="{% static 'css/cds-websites-collapse.css' %}" type="text/css" />
<style>
    .dropdown-menu.show::before {
        display: none !important;
    }
</style>
{% endblock %}

{% block centered_container %}

{% get_current_language as LANGUAGE_CODE %}

<h3 style="font-weight: normal;">
    {{ cds.cds_cod }} -
    {% if LANGUAGE_CODE == "it" or not cds.nome_cds_eng %}
        {{ cds.nome_cds_it }}
    {% else %}
        {{ cds.nome_cds_eng }}
    {% endif %}
</h3>
<hr>
<div class="card-wrapper card-space">
    <div class="card card-bg no-after">
        <div class="card-body">
            
            <table class="table table-sm table-striped table-responsive-sm">
                <thead class="table-dark sticky-top shadow-sm">
                    <tr class="d-flex">
                        <th class="col">{% trans "Object" %}</th>
                        <th class="col-auto col-md-2 col-xs-1 col-1 text-center text-truncate">{% trans "Type" %}</th>
                        <th class="col-auto col-md-2 col-xs-1 col-1 text-center text-truncate">{% trans "Visible" %}</th>
                        <th class="col-auto text-right">
                            <svg class="icon" style="visibility: hidden;">
                                <use xlink:href="{% static 'svg/sprite.svg' %}#it-search"></use>
                            </svg>
                        </th>
                    </tr>
                </thead>
                <tbody class="shadow-sm">
                    {% for obj in objects_list %}
                        <!-- Object list Remove Modal -->
                        <div class="modal fade"
                        tabindex="-1"
                        role="dialog"
                        id="remove_obj_list_{{obj.id}}">
                        <div class="modal-dialog modal-dialog-centered"
                                role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title">
                                        {% trans "Confirm" %}
                                    </h5>
                                    <button class="close"
                                            type="button"
                                            data-dismiss="modal"
                                            aria-label="Close">
                                        <svg class="icon">
                                            <use xlink:href="{% static 'svg/sprite.svg' %}#it-close"></use>
                                        </svg>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <p>
                                        {% trans "Removing this object will also remove it from every topic it has been added to. Do you want to remove this object?" %}
                                    </p>
                                </div>
                                <div class="modal-footer">
                                    <a class="btn btn-success btn-sm" href="{% url 'cds-websites:management:cds-websites-shared-object-delete' cds_id=cds.cds_id  data_id=obj.id %}">
                                        {% trans 'Yes, proceed' %}
                                    </a>
                                </div>
                            </div>
                            <!-- /Object list Remove Modal -->
                            <tr class="d-flex">
                                <td class="col align-content-center">
                                    {% if obj.titolo_it %}
                                        {{ obj.titolo_it }}
                                    {% else %}
                                        {{ obj.testo_it }}
                                    {% endif %}         
                                </td>
                                <td class="col-auto col-md-2 align-content-center text-center">
                                    {{ obj.id_classe_oggetto_portale }}   
                                </td>
                                <td class="col-auto col-md-2 align-content-center text-center">
                                {% if obj.visibile %}
                                    <svg class="icon icon-sm icon-success">
                                        <use xlink:href="{% static 'svg/sprite.svg' %}#it-check-circle"></use>
                                    </svg>
                                    {% else %}
                                    <svg class="icon icon-sm icon-danger">
                                        <use xlink:href="{% static 'svg/sprite.svg' %}#it-ban"></use>
                                    </svg>
                                {% endif %}
                                </td>
                                <td class="col-auto align-content-center text-right text-no-wrap">
                                    <div class="btn-group">
                                        <a href="javascript:void(0)" type="button" class="btn dropdown-toggle p-0" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                            <svg class="icon">
                                                <use xlink:href="{% static 'svg/sprite.svg' %}#it-more-actions"></use>
                                            </svg>
                                        </a>
                                        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                            <div class="link-list-wrapper">
                                                <ul class="link-list text-nowrap">
                                                    <li>
                                                        <a  href="{% url 'cds-websites:management:cds-websites-shared-object-edit' cds_id=cds.cds_id data_id=obj.id %}"
                                                            class="list-item left-icon">
                                                            {% if user_can_edit %}
                                                                <svg class="icon icon-dark left p-1 pl-2 mt-2">
                                                                    <use xlink:href="{% static 'svg/sprite.svg' %}#it-pencil"></use>
                                                                </svg>
                                                                <span class="text-primary">
                                                                    {% trans "Edit" %}
                                                                </span>
                                                            {% else %}
                                                                <svg class="icon icon-dark left p-1 pl-2 mt-2">
                                                                    <use xlink:href="{% static 'svg/sprite.svg' %}#it-search"></use>
                                                                </svg>
                                                                <span class="text-primary">
                                                                    {% trans "View" %}
                                                                </span>
                                                            {% endif %}
                                                        </a>
                                                    </li>
                                                    {% if user_can_edit %}
                                                        <li>
                                                            <span class="divider"></span>
                                                        </li>
                                                        <li>
                                                            <a  href="javascript:void(0)"
                                                                class="list-item left-icon"
                                                                data-toggle="modal"
                                                                data-target="#remove_obj_list_{{obj.id}}">
                                                                <svg class="icon icon-danger left p-1 pl-2 mt-2">
                                                                    <use xlink:href="{% static 'svg/sprite.svg' %}#it-delete"></use>
                                                                </svg>
                                                                <span class="text-danger">
                                                                    {% trans "Remove" %}
                                                                </span>
                                                            </a>
                                                        </li>
                                                    {% endif %}
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                    {% endfor %}
                </tbody>
            </table>
            {% if user_can_edit %}
            <a  href="{% url 'cds-websites:management:cds-websites-shared-object-new' cds_id=cds.cds_id %}"
                class="btn btn-xs btn-block btn-success">
                <svg class="icon icon-xs icon-white">
                    <use xlink:href="{% static 'svg/sprite.svg' %}#it-plus-circle"></use>
                </svg> {% trans "Add new" %}
            </a>
            {% endif %}

        </div>
    </div>
</div>

{% endblock centered_container %}